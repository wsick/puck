var puck;!function(t){t.version="0.1.0"}(puck||(puck={}));var puck;!function(t){var n;!function(t){!function(t){t[t.none=0]="none",t[t.opacity=1]="opacity",t[t.visible=2]="visible",t[t.transform=4]="transform",t[t.down=7]="down"}(t.DirtyFlags||(t.DirtyFlags={}));t.DirtyFlags}(n=t.element||(t.element={}))}(puck||(puck={}));var puck;!function(t){var n=t.element.DirtyFlags,e=function(){function e(t,n){this.init(t,n),Object.freeze(this)}return Object.defineProperty(e.prototype,"opacity",{get:function(){return this.state.opacity},set:function(t){this.state.opacity!==t&&(this.state.opacity=t,this.composite.taint(n.opacity))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this.state.visible},set:function(t){this.state.visible!==t&&(this.state.visible=t,this.composite.taint(n.visible))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.state.offset.x},set:function(t){this.state.offset.x!==t&&(this.state.offset.x=t,this.composite.taint(n.transform))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.state.offset.y},set:function(t){this.state.offset.y!==t&&(this.state.offset.y=t,this.composite.taint(n.transform))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.state.size.width},set:function(t){this.state.size.width!==t&&(this.state.size.width=t,this.composite.taint(n.transform))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.state.size.height},set:function(t){this.state.size.height!==t&&(this.state.size.height=t,this.composite.taint(n.transform))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transformOriginX",{get:function(){return this.state.transformOrigin.x},set:function(t){this.state.transformOrigin.x!==t&&(this.state.transformOrigin.x=t,this.composite.taint(n.transform))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transformOriginY",{get:function(){return this.state.transformOrigin.y},set:function(t){this.state.transformOrigin.y!==t&&(this.state.transformOrigin.y=t,this.composite.taint(n.transform))},enumerable:!0,configurable:!0}),e.prototype.resetTransform=function(){return la.mat3.identity(this.state.transform),this.composite.taint(n.transform),this},e.prototype.setTransform=function(t){return la.mat3.copyTo(t,this.state.transform),this.composite.taint(n.transform),this},e.prototype.applyTransform=function(t){return la.mat3.apply(this.state.transform,t),this},e.prototype.init=function(n,e){this.state=n||new t.container.ContainerState,this.composite=e||new t.container.ContainerComposite,this.processor={down:t.container.down.Processor.instance}},e}();t.Element=e}(puck||(puck={}));var __extends=this&&this.__extends||function(t,n){function e(){this.constructor=t}for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i]);t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)},puck;!function(t){var n=function(n){function e(t,e){n.call(this,t,e)}return __extends(e,n),e.prototype.init=function(n,e){this.elements=[],this.state=n||new t.container.ContainerState,this.composite=e||new t.container.ContainerComposite,this.processor={down:t.container.down.Processor.instance}},e.prototype.walk=function(){var t=-1,n=this.elements,e={next:function(){return t++,n[t]}};return e},e}(t.Element);t.Container=n}(puck||(puck={}));var puck;!function(t){var n;!function(t){var n=function(){function n(){this.$$dirt=t.DirtyFlags.none,this.opacity=1,this.visible=!0,this.transform=la.mat3.identity()}return n.prototype.hasDirt=function(t){return(this.$$dirt&t)>0},n.prototype.taint=function(t){this.$$dirt|=t},n.prototype.untaint=function(t){this.$$dirt&=~t},n.prototype.reset=function(){this.opacity=1,this.visible=!0,la.mat3.identity(this.transform)},n}();t.ElementComposite=n}(n=t.element||(t.element={}))}(puck||(puck={}));var puck;!function(t){var n;!function(n){var e=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n}(t.element.ElementComposite);n.ContainerComposite=e}(n=t.container||(t.container={}))}(puck||(puck={}));var puck;!function(t){var n;!function(t){var n=function(){function t(){this.opacity=1,this.visible=!0,this.offset={x:0,y:0},this.size={width:0,height:0},this.transform=la.mat3.identity(),this.transformOrigin={x:.5,y:.5}}return t.prototype.reset=function(){this.opacity=1,this.visible=!0,this.offset.x=0,this.offset.y=0,this.size.width=0,this.size.height=0,la.mat3.identity(this.transform),this.transformOrigin.x=.5,this.transformOrigin.y=.5},t}();t.ElementState=n}(n=t.element||(t.element={}))}(puck||(puck={}));var puck;!function(t){var n;!function(n){var e=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n}(t.element.ElementState);n.ContainerState=e}(n=t.container||(t.container={}))}(puck||(puck={}));var puck;!function(t){var n;!function(n){function e(n,o){i(n,o);for(var s=t.walk.getWalker(n),a=s.next();a;a=s.next())e(a,n);r(n,o)}function i(n,e){var i=n.processor.down,r={walker:t.walk.getWalker(n),state:n.state,composite:n.composite,pcomposite:e.composite};i.isTainted(r)&&i.process(r)}function r(t,n){}n.process=e}(n=t.engine||(t.engine={}))}(puck||(puck={}));var puck;!function(t){var n;!function(t){function n(t){return"function"==typeof t.walk?t.walk():e}var e={next:function(){}};t.getWalker=n}(n=t.walk||(t.walk={}))}(puck||(puck={}));var puck;!function(t){var n;!function(t){var n;!function(n){var e=function(){function e(){}return e.prototype.isTainted=function(n){return n.composite.hasDirt(t.DirtyFlags.down)},e.prototype.process=function(e){var i=t.DirtyFlags.none;return n.opacity.process(e)&&(i|=t.DirtyFlags.opacity),n.visible.process(e)&&(i|=t.DirtyFlags.visible),n.transform.process(e)&&(i|=t.DirtyFlags.transform),this.clear(e),i},e.prototype.clear=function(n){return n.composite.untaint(t.DirtyFlags.opacity|t.DirtyFlags.visible|t.DirtyFlags.transform),this},e.instance=new e,e}();n.Processor=e}(n=t.down||(t.down={}))}(n=t.element||(t.element={}))}(puck||(puck={}));var puck;!function(t){var n;!function(n){var e;!function(n){var e=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.process=function(n){for(var e=t.prototype.process.call(this,n),i=n.walker.next();i;i=n.walker.next())i.composite.taint(e);return e},n.instance=new n,n}(t.element.down.Processor);n.Processor=e}(e=n.down||(n.down={}))}(n=t.container||(t.container={}))}(puck||(puck={}));var puck;!function(t){var n;!function(t){var n;!function(n){var e;!function(n){function e(n){var e=n.composite;if(!e.hasDirt(t.DirtyFlags.opacity))return!1;var i=n.pcomposite.opacity*n.state.opacity,r=e.opacity===i;return e.opacity=i,r}n.process=e}(e=n.opacity||(n.opacity={}))}(n=t.down||(t.down={}))}(n=t.element||(t.element={}))}(puck||(puck={}));var puck;!function(t){var n;!function(t){var n;!function(n){var e;!function(n){function e(n){var e=n.composite;if(!e.hasDirt(t.DirtyFlags.transform))return!1;i.copyTo(e.transform,r);var o=n.state,s={x:o.transformOrigin.x*o.size.width,y:o.transformOrigin.y*o.size.height};return i.createTranslate(-s.x,-s.y,e.transform),i.apply(e.transform,o.transform),i.translate(e.transform,s.x,s.y),!i.equal(e.transform,r),!0}var i=la.mat3,r=i.identity();n.process=e}(e=n.transform||(n.transform={}))}(n=t.down||(t.down={}))}(n=t.element||(t.element={}))}(puck||(puck={}));var puck;!function(t){var n;!function(t){var n;!function(n){var e;!function(n){function e(n){var e=n.composite;if(!e.hasDirt(t.DirtyFlags.visible))return!1;var i=n.pcomposite.visible&&n.state.visible===!0,r=e.visible!==i;return e.visible=i,r}n.process=e}(e=n.visible||(n.visible={}))}(n=t.down||(t.down={}))}(n=t.element||(t.element={}))}(puck||(puck={}));
//# sourceMappingURL=puck.min.js.map
